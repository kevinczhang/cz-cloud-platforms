# S3 Versioning

S3 versioning is a feature to manage and store all old/new/deleted versions of an object:

* By default, versioning is disabled on all buckets/objects 
* Once versioning is enabled, you can only "suspend" versioning - It cannot be fully disabled 
* Suspending versioning only prevents new versions from being created 
* All objects with existing versions will maintain their older versions 
* Versioning can only be set on the bucket level and applies to ALL objects in the bucket
* Lifecycle policies can be applied to specific versions of an object: Versioning and lifecycle policies can both be enabled on a bucket at the same time Versioning can be used with lifecycle policies to create archiving and backup solutions

## Enabling S3 Versioning 

* Exisiting S3 objects remain unchanged: Exisiting objects in a bucket have a null version ID 
* Added objects are automatically given unique version IDs: 
  * Version IDs are generated by S3 
  * Version IDs will typically look something like this: 3/L4kqtJlcpXroDTDmJ+rmSpXd3dIbrHY 
  * The example version IDs are just examples 
* Every new version is billed as a full new S3 object: 
* Versions are full versions of new objects - not differences between versions 
* We can get object versions with the object key and the version ID

## Deleting Versioned Objects 

Standard workflow: 

* A delete is made to an object \(without specifying a version ID\) 
* All versions remain in the bucket \(no versions are actually deleted\) 
* S3 inserts a delete marker at the latest version 
* When you try to get the object, S3 returns a 404 
* You can still get a specific version of the object by specifying the Version ID

![](../../../.gitbook/assets/image%20%2833%29.png)

![](../../../.gitbook/assets/image%20%2827%29.png)

Permenantly delete a version: Make a delete request and specify the version to be deleted

![](../../../.gitbook/assets/image%20%2816%29.png)

## Restoring Versioned Objects 

### Deleting current versions: 

* Delete the current version 
* S3 then retrives the previous version 
* Repeat untill you have the version you want

### Copying old versions: 

* Copy a previous version of the object to the same bucket 
* This adds a new object to the bucket \(with a new version\) 
* The copied version becomes the current version 
* All object versions are preserved

